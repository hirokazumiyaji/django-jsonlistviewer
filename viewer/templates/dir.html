{% if node %}
{% if node.is_dir %}
<tr class="treegrid-{{ node.id }} {% if node.parent %}treegrid-parent-{{ node.parent.id }}{% endif %}">
  <td>{{ node.name }}</td>
</tr>
{% with 'dir.html' as self %}
{% for childnode in node.children %}
{% include self with node=childnode only %}
{% endfor %}
{% endwith %}
{% else %}
<tr class="treegrid-{{ node.id }} {% if node.parent %}treegrid-parent-{{ node.parent.id }}{% endif %}">
  <td><a href="{% url 'viewer-detail' node.url_path %}">{{ node.name }}</a></td>
</tr>
{% endif %}
{% endif %}
